<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Accepted Commands List</title>
        {% load static %}
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            integrity="...">
        <link rel="stylesheet" href="{% static 'admin/css/style.min.css' %}">
        <link
            rel="stylesheet"
            href="{% static 'admin/assets/plugins/bootstrap/dist/css/bootstrap.min.css' %}">
        <style>
            a {
                text-decoration: none;
            }
            #logo {
                margin-left: 40px;
            }
            #logo a {
                color: white;
                background-color: black;
                font-size: 35px;
            }
            .vl {
                border-left: 6px solid #4CAF50;
                height: 35px;
                margin-top: 5px;
                margin-bottom: -50px;
                width: 2px;
            }
            .navbar-collapse {
                margin-right: 50px;
            }
            /* Sidebar styling */
            #sidebarnav {
                padding: 15px;
                background-color: #f8f9fa;
                /* Set the background color of the sidebar */
            }

            /* Sidebar item styling */
            #sidebarnav .sidebar-item {
                list-style: none;
                margin-bottom: 10px;
            }

            /* Sidebar link styling within the sidebar item */
            #sidebarnav .sidebar-item > a {
                position: relative;
                display: block;
                padding: 10px 15px;
                color: #000000;
                /* Default text color */
                border-radius: 5px;
                transition: background-color 0.3s, color 0.3s;
                /* Add transitions */
            }

            /* Add this rule to style the active state of the sidebar link */
            #sidebarnav .sidebar-item.active > a {
                background-color: #4CAF50;
                /* Active background color */
                color: #ffffff !important;
                /* Active text color */
            }

            /* Hover effect for the sidebar link */
            #sidebarnav .sidebar-item > a:hover {
                background-color: #e4e4e4;
                /* Hover background color */
                color: #000000;
                /* Hover text color */
            }
            /* Style for the "Accepted Commands" link */
            #sidebarnav .sidebar-item.accepted-commands > a {
                background-color: #4CAF50;
                /* Green background color */
                color: #ffffff !important;
                /* White text color */
            }

            /* Dropdown styling */
            .dropdown-menu {
                display: none;
                position: absolute;
                background-color: white;
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
                border-radius: 5px;
                padding: 10px;
                z-index: 1;
            }

            .dropdown-menu.show {
                display: block;
            }

            .dropdown-menu a {
                color: black;
                text-decoration: none;
                display: block;
                padding: 8px 10px;
                transition: background-color 0.3s, color 0.3s;
            }

            .dropdown-menu a:hover {
                color: #4CAF50;
            }
        </style>
    </head>

    <body>
        <div class="preloader">
            <div class="lds-ripple">
                <div class="lds-pos"></div>
                <div class="lds-pos"></div>
            </div>
        </div>

        <div
            id="main-wrapper"
            data-layout="vertical"
            data-navbarbg="skin5"
            data-sidebartype="full"
            data-sidebar-position="absolute"
            data-header-position="absolute"
            data-boxed-layout="full">
            <header class="topbar" data-navbarbg="skin6">
                <nav
                    class="navbar top-navbar navbar-expand-md navbar-dark"
                    style="background-color: black;">
                    <div class="navbar-header" data-logobg="skin6">
                        <a class="navbar-brand ms-4" href="{% url 'index' %}">
                            <div class="vl"></div>
                            <div id="logo" class="pull-left">
                                <h1>
                                    <a href="#intro" class="scrollto">MarketMinds</a>
                                </h1>
                            </div>
                        </a>
                        <a
                            class="nav-toggler waves-effect waves-light text-white d-block d-md-none"
                            href="javascript:void(0)">
                            <i class="ti-menu ti-close"></i>
                        </a>
                    </div>
                    <div
                        class="navbar-collapse collapse"
                        id="navbarSupportedContent"
                        data-navbarbg="skin5">
                        <ul class="navbar-nav d-lg-none d-md-block ">
                            <li class="nav-item">
                                <a
                                    class="nav-toggler nav-link waves-effect waves-light text-white "
                                    href="javascript:void(0)">
                                    <i class="ti-menu ti-close"></i>
                                </a>
                            </li>
                        </ul>
                        <!-- Add your navigation items here -->
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <a class="nav-link text-white" href="{% url 'index' %}">Home</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link text-white" href="{% url 'dashboard' %}">Dashboard</a>
                            </li>
                            {% if user.is_authenticated %}

                                {% if user.photo %}
                                    <li class="menu-has-children nav-item dropdown">
                                        <a
                                            class="nav-link dropdown-toggle text-muted waves-effect waves-dark"
                                            href="#"
                                            id="navbarDropdown"
                                            role="button"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false"
                                            onclick="toggleDropdown()">
                                            <img src="{{ user.photo.url }}" alt="user" class="profile-pic me-2">{{user.name}} ùÖé
                                        </a>
                                        <ul
                                            id="userDropdownMenu"
                                            class="dropdown-menu"
                                            aria-labelledby="navbarDropdown">
                                            <!-- ... (your existing code) ... -->
                                        </ul>
                                    </li>
                                {% else %}
                                    <li class="menu-has-children nav-item dropdown">
                                        <a
                                            class="nav-link dropdown-toggle text-muted waves-effect waves-dark"
                                            href="#"
                                            id="navbarDropdown"
                                            role="button"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false"
                                            onclick="toggleDropdown()">
                                            <img
                                                src="{% static 'images/unknown.jpeg' %}"
                                                alt="user"
                                                class="profile-pic me-2">{{user.name}} ùÖé
                                        </a>
                                        <ul
                                            id="userDropdownMenu"
                                            class="dropdown-menu"
                                            aria-labelledby="navbarDropdown">
                                            {% if user.is_admin %}
                                                <li>
                                                    <a href="{% url 'profile' %}">Profile (Admin)</a>
                                                </li>
                                                <li>
                                                    <a href="{% url 'comand_list' %}">Commands</a>
                                                </li>
                                            {% else %}
                                                <li>
                                                    <a href="#">Profile</a>
                                                </li>
                                            {% endif %}
                                            <hr>
                                            <li>
                                                <a href="{% url 'logout' %}">logout</a>
                                            </li>
                                        </ul>
                                    </li>
                                {% endif %}

                            {% else %}
                                <li>
                                    <a href="{% url 'login' %}">login</a>
                                </li>
                            {% endif %}
                        </ul>
                    </div>
                </nav>
            </header>

            <aside class="left-sidebar" data-sidebarbg="skin6">
                <!-- Sidebar scroll-->
                <div class="scroll-sidebar">
                    <br/><br/>
                    <nav class="">
                        <ul id="sidebarnav">
                            <li class="sidebar-item">
                                <a
                                    class="sidebar-link waves-effect waves-dark"
                                    href="{% url 'dashboard' %}"
                                    aria-expanded="false">
                                    <i class="mdi me-2 mdi-gauge"></i>
                                    <span class="hide-menu">Dashboard</span>
                                </a>
                            </li>

                            <li class="sidebar-item">
                                <a
                                    class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="{% url 'profile' %}"
                                    aria-expanded="false">
                                    <i class="mdi me-2 mdi-account-check"></i>
                                    <span class="hide-menu">Profile</span></a>
                            </li>
                            <li class="sidebar-item">
                                <a
                                    class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="{% url 'comand_list' %}"
                                    aria-expanded="false">
                                    <i class="mdi me-2 mdi-table"></i>
                                    <span class="hide-menu">List of commands</span></a>
                            </li>
                            <li class="sidebar-item accepted-commands">
                                <!-- Add class to the specific item -->
                                <a
                                    class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="{% url 'accepted_commands_list' %}"
                                    aria-expanded="false">
                                    <i class="mdi me-2 mdi-table"></i>
                                    <span class="hide-menu">Accepted tasks</span></a>
                            </li>
                            <li class="sidebar-item">
                                <a
                                    class="sidebar-link waves-effect waves-dark sidebar-link"
                                    href="{% url 'completed_command_list'  %}"
                                    aria-expanded="false">
                                    <i class="mdi me-2 mdi-table"></i>
                                    <span class="hide-menu">Completed tasks</span></a>
                            </li>
                        </ul>
                    </nav>
                    <!-- End Sidebar navigation -->
                </div>
                <!-- End Sidebar scroll-->
                <div class="sidebar-footer">
                    <div class="row">
                        <div class="col-4 link-wrap">
                            <!-- item-->
                            <a
                                href=""
                                class="link"
                                data-toggle="tooltip"
                                title=""
                                data-original-title="Settings">
                                <i class="ti-settings"></i>
                            </a>
                        </div>
                        <div class="col-4 link-wrap">
                            <!-- item-->
                            <a
                                href=""
                                class="link"
                                data-toggle="tooltip"
                                title=""
                                data-original-title="Email">
                                <i class="mdi mdi-gmail"></i>
                            </a>
                        </div>
                        <div class="col-4 link-wrap">
                            <!-- item-->
                            <a
                                href=""
                                class="link"
                                data-toggle="tooltip"
                                title=""
                                data-original-title="Logout">
                                <i class="mdi mdi-power"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </aside>

            <div class="page-wrapper">
                <div class="page-breadcrumb">
                    <div class="row align-items-center">
                        <div class="col-md-6 col-8 align-self-center">
                            <div class="d-flex align-items-center">
                                <nav aria-label="breadcrumb">
                                    <ol class="breadcrumb">
                                        <li class="breadcrumb-item">
                                            <a href="#">Home</a>
                                        </li>
                                        <li class="breadcrumb-item active" aria-current="page">Table</li>
                                    </ol>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card">
                                <div class="card-body">
                                    <h4 class="card-title">Accepted Commands List</h4>
                                    <h6 class="card-subtitle">Add your subtitle here</h6>
                                    <div class="table-responsive">
                                        <table class="table user-table">
                                            <thead>
                                                <tr>
                                                    <th>Command ID</th>
                                                    <th>Client Name</th>
                                                    <th>Service Type</th>
                                                    <th>Price</th>
                                                    <th>Submission Date</th>
                                                    <th>Accepted Date</th>
                                                    <th>Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% if accepted_commands %}
                                                    {% for accepted_command in accepted_commands %}
                                                        <tr>
                                                            <td>{{ accepted_command.command.id }}</td>
                                                            <td>{{ accepted_command.command.client.name }}</td>
                                                            <td>{{ accepted_command.command.service_type.type }}</td>
                                                            <td>{{ accepted_command.command.price }}</td>
                                                            <td>{{ accepted_command.command.submission_date }}</td>
                                                            <td>{{ accepted_command.acceptance_date }}</td>
                                                            <td>
                                                                {% if not accepted_command.command.is_completed %}
                                                                    <form
                                                                        method="post"
                                                                        action="{% url 'complete_accepted_command' accepted_command.id %}">
                                                                        {% csrf_token %}
                                                                        <button
                                                                            type="submit"
                                                                            class="btn btn-primary"
                                                                            style="background-color: #4CAF50; border-color: #4CAF50; color: white;">
                                                                            Mark as Completed
                                                                        </button>
                                                                    </form>
                                                                {% endif %}
                                                            </td>
                                                        </tr>
                                                    {% endfor %}
                                                {% else %}
                                                    <tr>
                                                        <td colspan="6">No accepted commands available.</td>
                                                    </tr>
                                                {% endif %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script src="{% static 'admin/assets/plugins/jquery/dist/jquery.min.js' %}"></script>
            <script
                src="{% static 'admin/assets/plugins/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
            <script src="{% static 'admin/js/app-style-switcher.js' %}"></script>
            <script src="{% static 'admin/js/waves.js' %}"></script>
            <script src="{% static 'admin/js/sidebarmenu.js' %}"></script>
            <script src="{% static 'admin/js/custom.js' %}"></script>

            <script>
                function toggleDropdown() {
                    var dropdownMenu = document.getElementById("userDropdownMenu");
                    dropdownMenu
                        .classList
                        .toggle("show");
                }

                // Close the dropdown when clicking outside
                window.onclick = function (event) {
                    if (!event.target.matches('.nav-link.dropdown-toggle')) {
                        var dropdowns = document.getElementsByClassName("dropdown-menu");
                        for (var i = 0; i < dropdowns.length; i++) {
                            var openDropdown = dropdowns[i];
                            if (openDropdown.classList.contains('show')) {
                                openDropdown
                                    .classList
                                    .remove('show');
                            }
                        }
                    }
                }
            </script>
        </body>
    </html>